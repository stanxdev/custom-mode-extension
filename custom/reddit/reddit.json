{
    "request_rules": [
        {
            "id": "reddit.com => ${env.REDLIB_URL}",
            "descript": [
                "exception: ! at the end",
                "https://github.com/redlib-org/redlib-instances/blob/main/instances.md",
                "https://farside.link/libreddit"
            ],
            "action": {
                "type": "redirect",
                "redirect": {
                    "regexSubstitution": "https://${env.REDLIB_URL}/r/\\1"
                }
            },
            "condition": {
                "regexFilter": "^https://www\\.reddit\\.com/r/(.*)[^!]$",
                "resourceTypes": [
                    "main_frame"
                ]
            }
        },
        {
            "id": "${env.REDLIB_URL} ## theme ${env.REDLIB_THEME}",
            "descript": [
                " - set settings cookies",
                " - https://github.com/redlib-org/redlib?tab=readme-ov-file#default-user-settings",
                "       theme       dark, doomone, dracula, libredditDark, libredditLight, rosebox",
                "       hide_score  on, off",
                "       ..."
            ],
            "action": {
                "type": "modifyHeaders",
                "requestHeaders": [
                    {
                        "header": "cookie",
                        "operation": "append",
                        "value": "theme=${env.REDLIB_THEME};hide_score=off;fixed_navbar=off"
                    }
                ]
            },
            "condition": {
                "regexFilter": "^https://.*?(red|rl|lr).*?/r/.*[^!]$",
                "resourceTypes": [
                    "main_frame"
                ]
            }
        }
    ]
}
